[{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthijs S. Berends. Author, maintainer. Gerolf C. de Boer. Author. University Medical Center Groningen. Copyright holder, funder.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Berends MS, de Boer GC (2025). mmbi.epi: Helper Functions Unit Epidemiology & Data Science UMCG MMBI Department. R package version 0.0.8, https://umcg-mmbi-epidemiology.github.io/mmbi.epi/.","code":"@Manual{,   title = {mmbi.epi: Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department},   author = {Matthijs S. Berends and Gerolf C. {de Boer}},   year = {2025},   note = {R package version 0.0.8},   url = {https://umcg-mmbi-epidemiology.github.io/mmbi.epi/}, }"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/index.html","id":"mmbiepi","dir":"","previous_headings":"","what":"Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department","title":"Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department","text":"UMCG R package containing helper functions functionalities used department Medical Microbiology, unit Epidemiology & Data Science. Upon loading, official UMCG colours available :","code":"library(mmbi.epi)  get_colour(\"umcgdonkerblauw\") #> [1] \"#003183\"  get_colour(\"umcgoranje\") #> [1] \"#FF7D00\"  get_colour(\"umcg\", 2) #> [1] \"#003183\"  \"#FF7D00\""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/index.html","id":"glims-read-support","dir":"","previous_headings":"","what":"GLIMS read support","title":"Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department","text":"work GLIMS v9.* v10.*, ODBC connection available.","code":"library(mmbi.epi)  conn <- connect_db()  # download first 500 rows first_500 <- conn |>   glims_tbl(\"ANTIBIOTICRESULT\") |>   retrieve(500)  # joins conn |>   glims_tbl(\"REQUEST\") |>   glims_join_tbl(\"ORDER_\", by = c(\"RQST_ORDER\" = \"ORD_ID\")) |>   glims_join_tbl(\"SPECIMEN\", by = c(\"RQST_SPECIMEN\" = \"SPMN_ID\")) |>   glims_join_tbl(\"MATERIAL\", by = c(\"SPMN_MATERIAL\" = \"MAT_ID\")) |>   show_query()"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":null,"dir":"Reference","previous_headings":"","what":"GLIMS Database Access — connect_db","title":"GLIMS Database Access — connect_db","text":"Establishes connection GLIMS Oracle database using environment variables configuration parameters. function designed use secure environments Posit Workbench, credentials driver paths stored outside source code.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GLIMS Database Access — connect_db","text":"","code":"connect_db(db = \"Oracle\")  disconnect_db(con)  glims_tbl(con, table_name, schema = \"ORAGLIMS\")  get_glims_data(   date_range = NULL,   ...,   additional_columns = character(0),   convert_julian = TRUE,   convert_logicals = TRUE,   convert_column_names = TRUE,   limit = Inf,   qry_type = c(\"results\", \"orders\"),   db = \"Oracle\",   only_include_labs = \"Medische Microbiologie\",   ab_type = c(\"reported_sir\", \"raw_sir\", \"raw_mic\", \"raw_disk\", \"raw_etest\"),   review_qry = interactive() )  db  glims_join_tbl(   qry,   table_name,   by = NULL,   ...,   type = \"left\",   schema = \"ORAGLIMS\" )  oracle_julian_to_datetime(x, tz = \"Europe/Amsterdam\")  datetime_to_oracle_julian(x)  build_query(   con,   ...,   qry_type = \"results\",   additional_columns = character(0),   only_include_labs = \"Medische Microbiologie\" )  preview(qry, n = 100)  retrieve(   qry,   limit = Inf,   convert_julian = TRUE,   convert_logicals = TRUE,   convert_column_names = TRUE,   message_text = \"Collecting data\" )  retrieve_query(x)  search_for_test(db = \"Oracle\")  search_for_specimen(db = \"Oracle\")  search_for_ward(db = \"Oracle\")  search_for_specialism(db = \"Oracle\")  search_for_physician(db = \"Oracle\")  search_for_microorganism(db = \"Oracle\")"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"GLIMS Database Access — connect_db","text":"object class list length 1075.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GLIMS Database Access — connect_db","text":"db Database connect . con Connection object. table_name Name table query. schema Database schema; upper structure name table_name. date_range Date range, can length 1 2 (use min/max) filter ORD_RECEIPTTIME column. Supports date/time, date, years. Use NULL set date filter. ... glims_join_tbl(): Arguments passed join functions. .  * Otherwise: Arguments passed clause query. Supports dplyr language. additional_columns Character vector additional column names return. convert_julian Logical, whether convert Oracle Julian date fields Date POSIXct. convert_logicals Logical, whether convert binary numeric fields (0/1) logicals. convert_column_names Logical, whether rename column names using lookup table package. limit Maximum number rows return. end result probably fewer results due post-process data cleaning; limit setting applies original database query. qry_type Type query, see Query Types . only_include_labs Laboratories include, defaults \"Medische Microbiologie\". sets DEPARTMENT.DEPTNAME. ab_type Type AMR results return. Defaults \"reported_sir\" reflect final lab result. Can also \"raw_sir\", \"raw_mic\", \"raw_disk\", \"raw_etest\". review_qry Logical indicate whether  query must reviewed running. qry tbl_dbi object representing database query. Column name(s) join . Can named vector allow different names:= c(\"col_A\" = \"col_B\"). type Direction join, defaults \"left\". \"inner\": returns matched x rows. \"left\": returns x rows. \"right\": returns matched x rows, followed unmatched y rows. \"full\": returns x rows, followed unmatched y rows. x Numeric vector data.frame, convert Oracle Julian days common dates. case data frames, columns numeric values Julian days 1900-01-01 2100-01-01 converted. tz Target time zone. n Number rows collect. message_text Text show console retrieving data.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GLIMS Database Access — connect_db","text":"Returns live DBIConnection object can used DBI, dplyr, dbplyr querying manipulating data.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"environment-variables","dir":"Reference","previous_headings":"","what":"Environment Variables","title":"GLIMS Database Access — connect_db","text":"db set \"Oracle\", following environment variables must defined using function: MMBI_EPIDS_DRIVER - Full path , name , Oracle ODBC driver shared library MMBI_EPIDS_HOST - Hostname IP address Oracle database server MMBI_EPIDS_PORT - Port number Oracle service (typically 1521) MMBI_EPIDS_SVC - Oracle Service Name (SVC) SID identifying database instance MMBI_EPIDS_USER - Oracle database username MMBI_EPIDS_PASS - Oracle database password environment variables read runtime using Sys.getenv() passed DBI::dbConnect(). approach ensures credentials never exposed source code logs.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"picking-columns-with-db-","dir":"Reference","previous_headings":"","what":"Picking Columns with db$","title":"GLIMS Database Access — connect_db","text":"Always use db object (list) pick database columns filtering. contains GLIMS column names. must always preceded injection operator !! (pronounced \"bang-bang\"). example:","code":"get_glims_data(2025, !!db$specimen_name == \"Sputum\")   # writing `db$` will bring up all columns  get_glims_data(2025, ORD_ID == 461098)                 # Does not work get_glims_data(2025, !!str2lang(\"ORD_ID\") == 461098)   # Works get_glims_data(2025, !!db$ORDER_.ORD_ID == 461098)     # Works and easier to write  con |> build_query(!!db$specimen_name == \"Sputum\") |> retrieve()"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"query-types","dir":"Reference","previous_headings":"","what":"Query Types","title":"GLIMS Database Access — connect_db","text":"Various query types defined: \"orders\" (always included): 1 row per order (can contain multiple specimens): info request (department, ward, room, etc.) \"stays\": 1 row per patient movement admissions dates: info every ward admission room, can multiple order \"results\": 1 row per result, can multiple order \"isolates\": 1 row per isolate, can multiple result \"carriers\": 1 row per carrier (agar plate), can multiple isolate \"microscopy\": 1 row per microscopy result, can multiple result types can combined.","code":""},{"path":[]},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/db.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GLIMS Database Access — connect_db","text":"","code":"if (FALSE) { # \\dontrun{  # Opening Connection ---------------------------------------------------  # open connection and save as object conn <- connect_db()  # connect to a table conn |>   glims_tbl(\"ANTIBIOTICRESULT\")   # Running Queries ------------------------------------------------------  library(dplyr)  # download first 500 rows first_500 <- conn |>   glims_tbl(\"ANTIBIOTICRESULT\") |>   retrieve(500)  # dplyr functions are automatically translated into SQL conn |>   glims_tbl(\"ANTIBIOTICRESULT\") |>   filter(ABRS_RISRAWVALUE == 3) |>   show_query() # use collect() or retrieve() instead to download  # more advanced queries can still run server-side my_count <- conn |>   glims_tbl(\"ANTIBIOTICRESULT\") |>   filter(ABRS_RISRAWVALUE == 3) |>   count(ABRS_RISREPORTVALUECHANGED) |>   show_query() |> # first show query   collect()       # then immediately run and download data  # join to other columns server-side conn |>   glims_tbl(\"ANTIBIOTICRESULT\") |>   glims_join_tbl(\"ANOTHERTABLE\", by = \"some_column\") |>   show_query()   # Closing Connection ---------------------------------------------------  disconnect_db(conn)  } # }   # Other ----------------------------------------------------------------  datetime_to_oracle_julian(Sys.Date()) #> [1] 2460999  Sys.Date() #> [1] \"2025-11-19\" Sys.Date() |> datetime_to_oracle_julian() |> oracle_julian_to_datetime() #> [1] \"2025-11-19\"  Sys.time() #> [1] \"2025-11-19 14:57:33 UTC\" Sys.time() |> datetime_to_oracle_julian() |> oracle_julian_to_datetime() #> [1] \"2025-11-19 15:57:33 CET\" Sys.time() |> datetime_to_oracle_julian() |> oracle_julian_to_datetime(tz = \"UTC\") #> [1] \"2025-11-19 14:57:33 UTC\""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/gis-datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"GIS Data Sets — gis-datasets","title":"GIS Data Sets — gis-datasets","text":"data sets inherited certegis package.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/gis-datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GIS Data Sets — gis-datasets","text":"","code":"geo_gemeenten  geo_ggdregios  geo_nuts3  geo_postcodes2  geo_postcodes3  geo_postcodes4  geo_postcodes6  geo_provincies  postcodes  postcodes4_afstanden"},{"path":[]},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/gis-datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GIS Data Sets — gis-datasets","text":"","code":"geo_provincies #> Simple feature collection with 12 features and 3 fields #> Geometry type: MULTIPOLYGON #> Dimension:     XY #> Bounding box:  xmin: 13565.4 ymin: 306846.2 xmax: 278026.1 ymax: 619352.4 #> Projected CRS: Amersfoort / RD New #> First 10 features: #>        provincie inwoners oppervlakte_km2                       geometry #> 1        Drenthe   494705        2680.368 MULTIPOLYGON (((228930.1 57... #> 2      Flevoland   428210        1466.570 MULTIPOLYGON (((164912.9 51... #> 3      Friesland   651430        3531.269 MULTIPOLYGON (((154047.9 56... #> 4     Gelderland  2096460        5118.931 MULTIPOLYGON (((169898.4 48... #> 5      Groningen   586920        2392.983 MULTIPOLYGON (((276560.6 58... #> 6        Limburg  1115835        2210.001 MULTIPOLYGON (((192680.3 41... #> 7  Noord-Brabant  2573810        5054.037 MULTIPOLYGON (((100303.1 41... #> 8  Noord-Holland  2887460        2864.383 MULTIPOLYGON (((150846.9 47... #> 9     Overijssel  1166335        3408.845 MULTIPOLYGON (((182721.3 51... #> 10       Utrecht  1360955        1553.980 MULTIPOLYGON (((130059 4794...  geo_provincies |>   plot2(title = \"Inwoners in Nederlandse provincies\") #> ℹ Assuming datalabels.centroid = TRUE. Set to FALSE for a point-on-surface #> placing of datalabels. #> ℹ Using category = inwoners #> ℹ Using datalabels = provincie   geo_provincies |>   plot2(colour_fill = \"umcgoranje\") #> ℹ Adding white to the category scale - set two colours to colour_fill to #> prevent this. #> ℹ Assuming datalabels.centroid = TRUE. Set to FALSE for a point-on-surface #> placing of datalabels. #> ℹ Using category = inwoners #> ℹ Using datalabels = provincie   geo_gemeenten |>   filter_geolocation(provincie == \"Groningen\") |>   plot2(category = inwoners / oppervlakte_km2,         category.title = \"Inwoners per km^2\",         title = \"Populatiedichtheid in Groningse gemeenten\") #> ℹ Assuming datalabels.centroid = TRUE. Set to FALSE for a point-on-surface #> placing of datalabels. #> ℹ Using datalabels = gemeente   geo_gemeenten |>   filter_geolocation(provincie == \"Groningen\") |>   plot2(category = inwoners / oppervlakte_km2,         category.title = \"Inwoners per km^2\",         title = \"Populatiedichtheid in Groningse gemeenten\",         subtitle = \"Met postcode-4 als overlay\",         datalabels = FALSE,         colour = \"umcgblauw\",         linewidth = 1) |>   add_sf(geo_postcodes4 |> filter_geolocation(provincie == \"Groningen\"),          colour = \"umcgoranje\",          colour_fill = NA,          linewidth = 0.25) #> ! In 'sf' plots, colour will set the borders, not the areas - did you mean #> colour_fill = \"umcgblauw\"?"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/mmbi.epi-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mmbi.epi: Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department — mmbi.epi-package","title":"mmbi.epi: Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department — mmbi.epi-package","text":"UMCG R package containing helper functions functionalities used department Medical Microbiology, unit Epidemiology & Data Science.","code":""},{"path":[]},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/mmbi.epi-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mmbi.epi: Helper Functions for Unit Epidemiology & Data Science of UMCG MMBI Department — mmbi.epi-package","text":"Maintainer: Matthijs S. Berends m.s.berends@umcg.nl Authors: Gerolf C. de Boer contributors: University Medical Center Groningen [copyright holder, funder]","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/ms365.html","id":null,"dir":"Reference","previous_headings":"","what":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","title":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","text":"collection helper functions interacting Microsoft 365 groups, including Teams, Planner, SharePoint, via AzureGraph package. functions simplify retrieval group information, access associated resources (Planner, SharePoint, Teams), file transfer operations local storage SharePoint, including RDS import/export utilities.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/ms365.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","text":"","code":"get_ms365_group(group_name = \"MMBI Unit Epidemiologie & Data Science\")  get_planner(   ms365_group = get_ms365_group(),   plan_id = \"xHLwHUqf_UKoTxaPT6gh5pYAHsuB\" )  get_drive(ms365_group = get_ms365_group())  get_sharepoint_site(ms365_group = get_ms365_group())  get_teams(ms365_group = get_ms365_group())  get_drive_file(remote_path, ms365_group = get_ms365_group())  download_sharepoint_file(   remote_path,   destination,   overwrite = FALSE,   ms365_group = get_ms365_group() )  upload_sharepoint_file(   local_path,   remote_path,   ms365_group = get_ms365_group() )  import_sharepoint_rds(remote_path, ms365_group = get_ms365_group())  export_sharepoint_rds(object, remote_path, ms365_group = get_ms365_group())  open_sharepoint_analysis_file(remote_path, ms365_group = get_ms365_group())  save_sharepoint_analysis_file(   local_path = get_current_file_path(),   remote_path = NULL,   ms365_group = get_ms365_group() )  get_current_file_path()"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/ms365.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","text":"group_name Character scalar. Name Microsoft 365 group connect . Defaults \"MMBI Unit Epidemiologie & Data Science\". ms365_group az_group object obtained get_ms365_group(). Defaults calling get_ms365_group() automatically. plan_id Identifier Planner. remote_path Character scalar. Path file folder SharePoint (relative group drive root). save_sharepoint_analysis_file() default taken first file line. destination Character scalar. Local path SharePoint file downloaded. overwrite Logical. Whether overwrite existing local remote file. Default FALSE. local_path Character scalar. Path local file upload SharePoint. object R object saved .rds file uploaded SharePoint.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/ms365.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","text":"functions use AzureGraph package authenticate connect Microsoft 365 resources within umcgonline tenant. Authentication attempted using existing cached login; unavailable, user prompted log interactively.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/ms365.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Microsoft 365 Group and SharePoint Utilities — get_ms365_group","text":"","code":"if (FALSE) { # \\dontrun{   # Get from / Save to SharePoint ----------------------------------------  # Export data set to remote mtcars |> export_sharepoint_rds(\"Projecten/Overig/mtcars.rds\")  # Import data set from remote df <- import_sharepoint_rds(\"Projecten/Overig/iris.rds\")  # Open analysis file in RStudio from remote open_sharepoint_analysis_file(\"Projecten/Overig/my_file.R\")  # Save current analysis file to remote save_sharepoint_analysis_file() # or press the button in the Addins menu in RStudio   # Other Helper Functions -----------------------------------------------  # Download a file from SharePoint download_sharepoint_file(\"Projecten/Overig/my_remote_file.csv\", \"my_local_file.csv\")  # Upload a local file to SharePoint upload_sharepoint_file(\"my_local_file.csv\", \"Projecten/Overig/my_remote_file.csv\")  # Access Teams teams <- get_teams() # Send a message teams$get_channel(\"General\")$send_message(\"This is message from R\")  # Access Planner planner <- get_planner() planner$list_tasks() } # }"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/plot_style_umcg.html","id":null,"dir":"Reference","previous_headings":"","what":"UMCG Plot Style — scale_colour_umcg","title":"UMCG Plot Style — scale_colour_umcg","text":"ggplot2 helpers add organisational colours ggplot objects.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/plot_style_umcg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UMCG Plot Style — scale_colour_umcg","text":"","code":"scale_colour_umcg(..., n)  scale_fill_umcg(..., n)  register_umcg_plot_style()  unregister_umcg_plot_style()"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/plot_style_umcg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"UMCG Plot Style — scale_colour_umcg","text":"... arguments passed ggplot2::scale_colour_manual() ggplot2::scale_fill_manual() n Number colours required.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/plot_style_umcg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"UMCG Plot Style — scale_colour_umcg","text":"","code":"library(ggplot2)  p <- mtcars |>   ggplot(aes(x = hp,              y = mpg,              colour = as.factor(vs)),              fill = as.factor(vs)) +   geom_point(size = 3) +   geom_smooth() #> Warning: Arguments in `...` must be used. #> ✖ Problematic argument: #> • fill = as.factor(vs) #> ℹ Did you misspell an argument name? p #> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'   p +   scale_colour_umcg(n = 2) +   scale_fill_umcg(n = 2) +   labs(title = \"UMCG colours\") #> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'   # With plot2(), this all goes automatically with less code mtcars |>   plot2(x = hp,         y = mpg,         category = as.factor(vs),         smooth = TRUE,         title = \"Fully UMCG-styled plot\",         subtitle = \"(with the right font too; 'Outfit' from Google Fonts)\") #> ℹ Using type = \"point\" since both axes are numeric #> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. certegis add_map, .sf, cases_within_radius, convert_to_metre_CRS28992, degrees_to_sf, filter_geolocation, filter_sf, geocode, .sf, latitude, longitude, reverse_geocode plot2 add_line, add_sf, add_smooth, add_type, get_colour, plot2","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":null,"dir":"Reference","previous_headings":"","what":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"Securely serialise, compress, encrypt, transfer R object full attribute preservation cross-platform JSON compatibility.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"","code":"serialise(object, compress = TRUE, as_character = TRUE)  deserialise(object, decompress = TRUE)  encrypt(x, key = Sys.getenv(\"mmbi_epi_encryption_key\"), as_character = TRUE)  decrypt(x, key = Sys.getenv(\"mmbi_epi_encryption_key\"), as_character = TRUE)  post_data(   object,   url,   authorization_header = NULL,   compress = TRUE,   encrypt = TRUE,   key = Sys.getenv(\"mmbi_epi_encryption_key\") )  create_json_body(   object,   compress = TRUE,   encrypt = TRUE,   key = Sys.getenv(\"mmbi_epi_encryption_key\") )  read_json_body(   object,   decompress = TRUE,   decrypt = NULL,   key = Sys.getenv(\"mmbi_epi_encryption_key\") )"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"object object size, preferably data set compress, decompress serialised object compressed/decompressed? least allowed: \"gzip\" (TRUE), \"bzip2\", \"xz\", see base::memCompress(). Use FALSE compress/decompress. as_character logical indicate whether output converted character string. Note limit 2,147,483,647 characters (= \\(2^{31} - 1\\) bytes = ~2 GB object size), raw vector used large inputs (.e., as_character = FALSE). x raw character vector key character used encryption key. Internally, converted using openssl::sha256() ensure raw high-entropy key length 32, suitable AES-GCM encryption. default system environment variable: mmbi_epi_encryption_key. url character string specifying target URL HTTP POST request. Must include full scheme (e.g., \"https://\" \"http://\"), hostname, path. authorization_header character string specifying value Authorization header include POST request, e.g. \"Bearer <token>\". Use NULL omit header. encrypt, decrypt serialised object encrypted/decrypted? applies AES-GCM via openssl::aes_gcm_encrypt(), providing authenticated encryption. guarantees confidentiality integrity: file read without correct key, tampering detected automatically decryption. initialization vector (iv) length-12 random raw vector.","code":""},{"path":[]},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"serialisation","dir":"Reference","previous_headings":"","what":"Serialisation","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"serialise() converts arbitrary R object transportable format wrapping metadata, including: Object-level attributes (via attributes()), data frames: per-column attributes, including class (e.g., factor, Date, POSIXct), levels, time zone information. wrapped structure converted JSON using jsonlite::toJSON(), consistent handling NULLs, NAs, timestamps. structure allows accurate reconstruction original object, including attributes, passed deserialise(). resulting JSON representation portable can decoded non-R environments Python. method avoids using base R serialize(), output R-specific unreadable elsewhere.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"compression","dir":"Reference","previous_headings":"","what":"Compression","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"compress = TRUE, serialise() uses gzip compression (memCompress(type = \"gzip\")) default. algorithms (\"bzip2\", \"xz\") supported. Compression reduces payload size requires algorithm used decompression. deserialise() read_json_body() corresponding memDecompress() step applied decompress = TRUE.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"encryption-aes-gcm-","dir":"Reference","previous_headings":"","what":"Encryption (AES-GCM)","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"encrypt() applies AES Galois/Counter Mode (GCM) via openssl::aes_gcm_encrypt(). AES-GCM provides authenticated encryption: guarantees confidentiality (content unreadable without key) integrity (bit-level modification detected decryption). fresh 12-byte initialisation vector (IV) generated encryption (rand_bytes(12)), required security. IV random/unique per call, ciphertext differs across runs even identical inputs; expected desirable. IV secret packaged alongside ciphertext decryption can succeed.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"transport","dir":"Reference","previous_headings":"","what":"Transport","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"post_data() sends JSON body httr::POST() using encode = \"json\" sets HTTP Authorization header pass one (example bearer token). receiving service can stack can: (1) parse JSON, (2) base64-decode fields, (3) perform AES-GCM decryption key IV, (4) gzip decompress, (5) deserialise JSON strings.","code":""},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"read-in-r","dir":"Reference","previous_headings":"","what":"Read in R","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"decrypt, decompress, process R receiving side, :","code":"library(mmbi.epi)  # assuming `json_payload` is received read_json_body(decompress = TRUE, decrypt = TRUE, key = \"my-key\")"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"read-in-python","dir":"Reference","previous_headings":"","what":"Read in Python","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"decrypt, decompress, process Python receiving side, :","code":"import json, base64, gzip import pandas as pd from Crypto.Cipher import AES from Crypto.Hash import SHA256  # assuming `json_payload` is received payload = json.loads(json_payload) ct = base64.b64decode(payload[\"data\"]) iv = base64.b64decode(payload[\"iv\"])  # key derivation (same as openssl::sha256 in R) key = SHA256.new(b\"my-key\").digest()  # decrypt (AES-GCM) cipher = AES.new(key, AES.MODE_GCM, nonce=iv) decrypted = cipher.decrypt(ct)  # decompress and parse decompressed = gzip.decompress(decrypted) df = pd.read_json(decompressed.decode(\"utf-8\"))"},{"path":"https://umcg-mmbi-epidemiology.github.io/mmbi.epi/reference/serialise-encrypt-post.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Serialise, Compress, Encrypt, and Transfer Data — serialise-encrypt-post","text":"","code":"# SERIALISATION AND ENCRYPTION -----------------------------------------  # in essence: iris2 <- iris |> serialise() |> deserialise() identical(iris, iris2) #> [1] TRUE # and: iris3 <- iris |> serialise() |> encrypt() |> decrypt() |> deserialise() identical(iris, iris3) #> [1] TRUE  # a serialised object is a representation for any type of data serialise(iris)[1:25] #>  [1] \"78\" \"9c\" \"b5\" \"5a\" \"4d\" \"8f\" \"5b\" \"37\" \"0c\" \"fc\" \"2f\" \"ef\" \"3c\" \"30\" \"1e\" #> [16] \"45\" \"52\" \"1f\" \"fe\" \"0d\" \"3d\" \"14\" \"c8\" \"a1\" \"87\"  # and can be converted back at any time iris |> serialise() |> deserialise() |> head() #>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species #> 1          5.1         3.5          1.4         0.2  setosa #> 2          4.9         3.0          1.4         0.2  setosa #> 3          4.7         3.2          1.3         0.2  setosa #> 4          4.6         3.1          1.5         0.2  setosa #> 5          5.0         3.6          1.4         0.2  setosa #> 6          5.4         3.9          1.7         0.4  setosa   # POSTING DATA ---------------------------------------------------------  # post_data() sends data using POST, after serialising (and encrypting)  if (FALSE) { # \\dontrun{  post_data(iris,           url = \"https://some-server:8000/post\",           compress = TRUE,           encrypt = TRUE) } # }  # use create_json_body() to make an encrypted JSON of an object, and # read_json_body() to read it back iris_json <- iris |> create_json_body(compress = TRUE, encrypt = TRUE) # (can be sent securely to a server) # then: iris4 <- iris_json |> read_json_body(decompress = TRUE, decrypt = TRUE) identical(iris, iris4) #> [1] TRUE  # equivalent using curl: # curl -X POST https://some-server:8000/post #      -H \"Content-Type: application/json\" #      -d '...'  # replace the \"...\" with the outcome of create_json_body(): iris_json #> {\"data\":\"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\",\"iv\":\"zZFRefyupOoOE8Jb\"}"}]
