<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Microsoft 365 Group and SharePoint Utilities — get_ms365_group • mmbi.epi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Microsoft 365 Group and SharePoint Utilities — get_ms365_group"><meta name="description" content="A collection of helper functions for interacting with Microsoft 365 groups, including
Teams, Planner, and SharePoint, via the AzureGraph package.
These functions simplify retrieval of group information, access to associated
resources (Planner, SharePoint, Teams), and file transfer operations
between local storage and SharePoint, including RDS import/export utilities."><meta property="og:description" content="A collection of helper functions for interacting with Microsoft 365 groups, including
Teams, Planner, and SharePoint, via the AzureGraph package.
These functions simplify retrieval of group information, access to associated
resources (Planner, SharePoint, Teams), and file transfer operations
between local storage and SharePoint, including RDS import/export utilities."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmbi.epi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/umcg-mmbi-epidemiology/mmbi.epi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Microsoft 365 Group and SharePoint Utilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/umcg-mmbi-epidemiology/mmbi.epi/blob/main/R/ms365.R" class="external-link"><code>R/ms365.R</code></a></small>
      <div class="d-none name"><code>ms365.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A collection of helper functions for interacting with Microsoft 365 groups, including
Teams, Planner, and SharePoint, via the <code>AzureGraph</code> package.</p>
<p>These functions simplify retrieval of group information, access to associated
resources (Planner, SharePoint, Teams), and file transfer operations
between local storage and SharePoint, including RDS import/export utilities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_ms365_group</span><span class="op">(</span>group_name <span class="op">=</span> <span class="st">"MMBI Unit Epidemiologie &amp; Data Science"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_planner</span><span class="op">(</span></span>
<span>  ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  plan_id <span class="op">=</span> <span class="st">"xHLwHUqf_UKoTxaPT6gh5pYAHsuB"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_drive</span><span class="op">(</span>ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_sharepoint_site</span><span class="op">(</span>ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_teams</span><span class="op">(</span>ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_drive_file</span><span class="op">(</span><span class="va">remote_path</span>, ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">download_sharepoint_file</span><span class="op">(</span></span>
<span>  <span class="va">remote_path</span>,</span>
<span>  <span class="va">destination</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">upload_sharepoint_file</span><span class="op">(</span></span>
<span>  <span class="va">local_path</span>,</span>
<span>  <span class="va">remote_path</span>,</span>
<span>  ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">import_sharepoint_rds</span><span class="op">(</span><span class="va">remote_path</span>, ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">export_sharepoint_rds</span><span class="op">(</span><span class="va">object</span>, <span class="va">remote_path</span>, ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">open_sharepoint_analysis_file</span><span class="op">(</span><span class="va">remote_path</span>, ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">save_sharepoint_analysis_file</span><span class="op">(</span></span>
<span>  local_path <span class="op">=</span> <span class="fu">get_current_file_path</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  remote_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ms365_group <span class="op">=</span> <span class="fu">get_ms365_group</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_current_file_path</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-group-name">group_name<a class="anchor" aria-label="anchor" href="#arg-group-name"></a></dt>
<dd><p>Character scalar. Name of the Microsoft 365 group to connect to. Defaults to <code>"MMBI Unit Epidemiologie &amp; Data Science"</code>.</p></dd>


<dt id="arg-ms-group">ms365_group<a class="anchor" aria-label="anchor" href="#arg-ms-group"></a></dt>
<dd><p>An <code>az_group</code> object obtained from <code>get_ms365_group()</code>. Defaults to calling <code>get_ms365_group()</code> automatically.</p></dd>


<dt id="arg-plan-id">plan_id<a class="anchor" aria-label="anchor" href="#arg-plan-id"></a></dt>
<dd><p>Identifier of the Planner.</p></dd>


<dt id="arg-remote-path">remote_path<a class="anchor" aria-label="anchor" href="#arg-remote-path"></a></dt>
<dd><p>Character scalar. Path to a file or folder on SharePoint (relative to the group drive root). For <code>save_sharepoint_analysis_file()</code> this will at default be taken from the first file line.</p></dd>


<dt id="arg-destination">destination<a class="anchor" aria-label="anchor" href="#arg-destination"></a></dt>
<dd><p>Character scalar. Local path where a SharePoint file should be downloaded.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical. Whether to overwrite an existing local or remote file. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-local-path">local_path<a class="anchor" aria-label="anchor" href="#arg-local-path"></a></dt>
<dd><p>Character scalar. Path to a local file to upload to SharePoint.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An R object to be saved as an <code>.rds</code> file and uploaded to SharePoint.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions use the <code>AzureGraph</code> package to authenticate and connect
to Microsoft 365 resources within the <code>umcgonline</code> tenant. Authentication is
attempted using an existing cached login; if unavailable, the user is prompted
to log in interactively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get from / Save to SharePoint ----------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Export data set to remote</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">|&gt;</span> <span class="fu">export_sharepoint_rds</span><span class="op">(</span><span class="st">"Projecten/Overig/mtcars.rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Import data set from remote</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">import_sharepoint_rds</span><span class="op">(</span><span class="st">"Projecten/Overig/iris.rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Open analysis file in RStudio from remote</span></span></span>
<span class="r-in"><span><span class="fu">open_sharepoint_analysis_file</span><span class="op">(</span><span class="st">"Projecten/Overig/my_file.R"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Save current analysis file to remote</span></span></span>
<span class="r-in"><span><span class="fu">save_sharepoint_analysis_file</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># or press the button in the Addins menu in RStudio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Other Helper Functions -----------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Download a file from SharePoint</span></span></span>
<span class="r-in"><span><span class="fu">download_sharepoint_file</span><span class="op">(</span><span class="st">"Projecten/Overig/my_remote_file.csv"</span>, <span class="st">"my_local_file.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Upload a local file to SharePoint</span></span></span>
<span class="r-in"><span><span class="fu">upload_sharepoint_file</span><span class="op">(</span><span class="st">"my_local_file.csv"</span>, <span class="st">"Projecten/Overig/my_remote_file.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access Teams</span></span></span>
<span class="r-in"><span><span class="va">teams</span> <span class="op">&lt;-</span> <span class="fu">get_teams</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Send a message</span></span></span>
<span class="r-in"><span><span class="va">teams</span><span class="op">$</span><span class="fu">get_channel</span><span class="op">(</span><span class="st">"General"</span><span class="op">)</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="st">"This is message from R"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access Planner</span></span></span>
<span class="r-in"><span><span class="va">planner</span> <span class="op">&lt;-</span> <span class="fu">get_planner</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">planner</span><span class="op">$</span><span class="fu">list_tasks</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthijs S. Berends, Gerolf C. de Boer, University Medical Center Groningen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

